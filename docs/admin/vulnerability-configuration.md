# Vulnerability Configuration - Admin Guide

## Overview

The Vulnerability Configuration feature allows administrators to manage vulnerability overdue tracking and exception handling. This guide covers how to configure the system and understand the overdue status logic.

---

## Table of Contents

1. [Accessing Configuration](#accessing-configuration)
2. [Configuring Reminder One Threshold](#configuring-reminder-one-threshold)
3. [Understanding Overdue Status](#understanding-overdue-status)
4. [Managing Exceptions](#managing-exceptions)
5. [Best Practices](#best-practices)
6. [Troubleshooting](#troubleshooting)

---

## Accessing Configuration

### Prerequisites
- ADMIN role required
- Access to the admin panel

### Steps to Access

1. Log in to Secman with admin credentials
2. Navigate to **Admin** from the home page
3. Click on **Vulnerability Settings** card
4. You'll see two tabs:
   - **Threshold Settings** - Configure the overdue threshold
   - **Exception Management** - Manage vulnerability exceptions

---

## Configuring Reminder One Threshold

### What is "Reminder One"?

"Reminder One" is the number of days after which a vulnerability is considered **OVERDUE**. This threshold helps track which vulnerabilities need immediate attention.

### Setting the Threshold

1. Navigate to **Admin → Vulnerability Settings**
2. Ensure you're on the **Threshold Settings** tab
3. You'll see the "Reminder One (Days)" input field
4. Enter a value between **1 and 365 days**
5. Click **Save Configuration**

### Recommended Values

| Security Posture | Threshold | Description |
|-----------------|-----------|-------------|
| **Aggressive** | 7-14 days | High alert volume, fast response needed |
| **Standard** | 30-60 days | Balanced approach (most organizations) |
| **Relaxed** | 90-120 days | Longer response window, lower volume |

**Default Value:** 30 days

### Warnings

The system will warn you about extreme values:

- **< 7 days**: May result in many overdue vulnerabilities, potentially overwhelming your team
- **> 180 days**: May reduce urgency of vulnerability remediation, increasing security risk

### Impact of Changes

Changes to the threshold take effect **immediately** and apply to:
- All current vulnerabilities
- All future vulnerability scans
- All vulnerability views across the system

The system will automatically recalculate overdue status for all vulnerabilities based on the new threshold.

---

## Understanding Overdue Status

### Status Types

Vulnerabilities can have one of three overdue statuses:

| Status | Badge | Meaning | Action Required |
|--------|-------|---------|----------------|
| **OK** | ✅ Green | Within threshold | Monitor |
| **OVERDUE** | 🔴 Red | Exceeds threshold | Remediate immediately |
| **EXCEPTED** | 🛡️ Blue | Has active exception | Review exception validity |

### How Status is Calculated

1. **Age Calculation**: System calculates days since the vulnerability was first scanned
2. **Threshold Comparison**: Compares age against the "Reminder One" threshold
3. **Exception Check**: Checks if an active exception exists for this vulnerability
4. **Status Assignment**:
   - If age ≤ threshold → **OK**
   - If age > threshold AND no exception → **OVERDUE**
   - If age > threshold AND has exception → **EXCEPTED**

### Example

**Scenario:**
- Reminder One threshold: 30 days
- Vulnerability scanned on: January 1, 2025
- Current date: February 15, 2025
- Age: 45 days

**Result:**
- 45 days > 30 days = **OVERDUE** (unless excepted)

---

## Managing Exceptions

Exceptions allow you to suppress the overdue status for specific vulnerabilities. There are three types of exceptions:

### Exception Types

#### 1. IP-Based Exception
**Use Case:** Exclude all vulnerabilities on a specific IP address

**Example:** Development server that won't be patched
```
Type: IP
Target: 192.168.1.100
```

#### 2. Product-Based Exception
**Use Case:** Exclude vulnerabilities for a specific software product/version

**Example:** Legacy software with known vulnerabilities that can't be upgraded
```
Type: PRODUCT
Target: OpenSSH 7.4
```

#### 3. Asset-Based Exception
**Use Case:** Exclude all vulnerabilities on a specific asset (by database ID)

**Example:** Server scheduled for decommissioning
```
Type: ASSET
Target: [Select from dropdown]
```

### Creating an Exception

1. Navigate to **Admin → Vulnerability Settings → Exception Management** tab
2. Click **Create Exception** button
3. Fill in the exception form:

#### Form Fields

| Field | Required | Description |
|-------|----------|-------------|
| **Exception Type** | Yes | Choose IP, PRODUCT, or ASSET |
| **Target** | Yes | Depends on type (IP address, product name, or asset selection) |
| **Expiration Date** | Yes | When the exception expires (future date only) |
| **Reason** | Yes | Justification for the exception |

4. Click **Preview & Create** (for PRODUCT type) or **Create** (for IP/ASSET)
5. Review the impact preview (if shown)
6. Confirm creation

### Editing an Exception

1. Locate the exception in the table
2. Click the **Edit** (pencil) button
3. Modify the **Expiration Date** or **Reason** (Type and Target cannot be changed)
4. Click **Save**

**Note:** To change the type or target, you must delete and recreate the exception.

### Deleting an Exception

1. Locate the exception in the table
2. Click the **Delete** (trash) button
3. Confirm the deletion in the dialog
4. The exception is immediately removed

**Warning:** Deleting an exception will cause affected vulnerabilities to become OVERDUE (if they exceed the threshold).

### Exception Expiration

- All exceptions require an **end date**
- Expired exceptions are marked with a **red "Expired" badge**
- Expired exceptions no longer suppress overdue status
- You can edit an expired exception to extend its expiration date
- Consider deleting truly obsolete exceptions to keep the list clean

### Affected Vulnerability Count

Each exception shows how many vulnerabilities it affects:

- **0 vulns**: Exception matches no current vulnerabilities
- **1-9 vulns**: Low impact (green badge)
- **10-49 vulns**: Medium impact (yellow badge)
- **50+ vulns**: High impact (red badge)

This helps you understand the scope of each exception.

---

## Best Practices

### Threshold Configuration

1. **Start Conservative**: Begin with 30 days and adjust based on your team's capacity
2. **Monitor Volume**: Track how many OVERDUE vulnerabilities you get
3. **Adjust Gradually**: Change threshold in small increments (10-15 days)
4. **Document Changes**: Note why you changed the threshold (tracked automatically)

### Exception Management

1. **Be Specific**: Use ASSET or IP exceptions rather than broad PRODUCT exceptions when possible
2. **Short Expiration**: Set exceptions to expire in 30-90 days initially
3. **Document Thoroughly**: Always provide a clear, detailed reason
4. **Regular Review**: Review exceptions monthly to remove obsolete ones
5. **Avoid Permanent Exceptions**: If something truly can't be fixed, consider accepting the risk differently
6. **Track Remediation**: If exception is for planned work, update expiration to match work schedule

### Communication

1. **Announce Changes**: Tell your team when you change the threshold
2. **Explain Exceptions**: Document why exceptions exist for transparency
3. **Set Expectations**: Help teams understand what OVERDUE means
4. **Report Regularly**: Share overdue vulnerability counts with management

---

## Troubleshooting

### Q: I can't access the Vulnerability Settings page

**A:** Ensure you have the ADMIN role. Only administrators can access this page. Contact your system administrator if you believe you should have access.

### Q: Changes to threshold aren't showing immediately

**A:** Changes are immediate. Try:
1. Refresh the vulnerabilities page (Ctrl+F5 or Cmd+Shift+R)
2. Clear browser cache
3. Log out and log back in

### Q: Exception isn't suppressing overdue status

**A:** Check:
1. Exception expiration date is in the future
2. Exception target matches exactly (for IP/PRODUCT)
3. Asset ID is correct (for ASSET exceptions)
4. Exception status shows "Active" (not "Expired")

### Q: Too many vulnerabilities are OVERDUE

**A:** Consider:
1. **Increase threshold**: If 30 days is too aggressive, try 45 or 60 days
2. **Create exceptions**: For vulnerabilities that can't be fixed immediately
3. **Prioritize remediation**: Focus on Critical and High severity first
4. **Review scan frequency**: Ensure scans aren't duplicating vulnerabilities

### Q: Can I change an exception's type or target?

**A:** No. Exception type and target are immutable once created. To change them:
1. Note the current exception details
2. Delete the existing exception
3. Create a new exception with the correct type/target

### Q: What happens when an exception expires?

**A:** 
1. The exception status changes to "Expired" (red badge)
2. Affected vulnerabilities are recalculated
3. Vulnerabilities exceeding threshold become OVERDUE
4. You can edit the exception to extend the expiration date

### Q: Can regular users create exceptions?

**A:** No. Exception management requires the ADMIN role. Regular users can only view overdue statuses.

### Q: How do I see which vulnerabilities are affected by an exception?

**A:** 
1. Look at the "Affected" column in the exceptions table
2. Click on the affected count (if clickable) to see details
3. For PRODUCT exceptions, use the impact preview before creating

---

## Security Considerations

1. **Access Control**: Only grant ADMIN role to trusted users
2. **Audit Trail**: All configuration changes are logged with user and timestamp
3. **Exception Justification**: Always require meaningful reasons for exceptions
4. **Regular Audits**: Review exceptions regularly to prevent abuse
5. **Expiration Enforcement**: Don't allow indefinite exceptions without strong justification

---

## Related Documentation

- [User Guide: Understanding Overdue Status](../user/understanding-overdue-status.md)
- [Developer Guide: API Endpoints](../developer/api-endpoints.md)

---

## Support

For additional help:
- Contact your system administrator
- Review the FAQ section
- Check the vulnerability management documentation

---

**Last Updated:** 2025-10-16  
**Version:** 1.0  
**Feature:** 021-vulnerability-overdue-exception-logic
