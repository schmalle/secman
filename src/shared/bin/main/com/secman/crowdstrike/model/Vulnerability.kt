package com.secman.crowdstrike.model

import java.time.LocalDate

/**
 * Represents a security vulnerability detected on a host
 */
data class Vulnerability(
    val cveId: String,
    val severity: Severity,
    val affectedSoftware: String,
    val description: String,
    val descriptionFull: String? = null,
    val cvssScore: Double? = null,
    val publishedDate: LocalDate? = null,
    val remediation: String? = null
) {
    init {
        require(cveId.matches(Regex("^CVE-\\d{4}-\\d{4,}$"))) { "Invalid CVE ID format: $cveId" }
        require(description.isNotBlank()) { "Description cannot be blank" }
        cvssScore?.let {
            require(it in 0.0..10.0) { "CVSS score must be between 0.0 and 10.0, got $it" }
        }
    }

    fun toDisplayString(): String = if (description.length > 100) {
        description.take(100) + "..."
    } else {
        description
    }
}
