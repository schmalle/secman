---
/**
 * Vulnerability Statistics Lense Page
 *
 * Main dashboard for vulnerability analytics displaying:
 * - Top 10 most common vulnerabilities with access control (US1)
 * - Severity distribution pie chart (US2)
 *
 * Access Control:
 * - ADMIN users see all vulnerabilities
 * - Other users see vulnerabilities from workgroup-assigned assets and personally owned assets
 *
 * Feature: 036-vuln-stats-lense
 * Task: T017 [US1]
 * Spec reference: spec.md Section "User Scenarios & Testing"
 */

import Layout from '../layouts/Layout.astro';
import MostCommonVulnerabilities from '../components/statistics/MostCommonVulnerabilities';
import MostVulnerableProducts from '../components/statistics/MostVulnerableProducts';
import SeverityDistributionChart from '../components/statistics/SeverityDistributionChart';
---

<Layout title="Vulnerability Statistics - Lense">
  <div class="container-fluid py-4">
    <!-- Page Header -->
    <div class="row mb-4">
      <div class="col-12">
        <h1 class="display-5">
          <i class="bi bi-bar-chart-line me-2"></i>
          Vulnerability Statistics Lense
        </h1>
        <p class="text-muted">
          Comprehensive vulnerability analytics and trends across your accessible assets
        </p>
      </div>
    </div>

    <!-- User Story 1: Most Common Vulnerabilities (P1/MVP) -->
    <div class="row mb-4">
      <div class="col-12">
        <MostCommonVulnerabilities client:load />
      </div>
    </div>

    <!-- Most Vulnerable Products -->
    <div class="row mb-4">
      <div class="col-12">
        <MostVulnerableProducts client:load />
      </div>
    </div>

    <!-- User Story 2: Severity Distribution (P2) -->
    <div class="row mb-4">
      <div class="col-12">
        <SeverityDistributionChart client:load />
      </div>
    </div>
  </div>
</Layout>
