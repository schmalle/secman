micronaut:
  application:
    name: secman-backend-ng
  server:
    port: 8080
    cors:
      enabled: true
      configurations:
        web:
          allowed-origins:
            - "http://localhost:4321"
            - "http://localhost:3000" 
          allowed-methods:
            - GET
            - POST
            - PUT
            - DELETE
            - OPTIONS
          allowed-headers:
            - Content-Type
            - Authorization
            - Accept
            - Origin
            - Csrf-Token
          exposed-headers:
            - Authorization
          allow-credentials: true
          max-age: 3600
  security:
    authentication: bearer
    token:
      jwt:
        signatures:
          secret:
            generator:
              secret: ${JWT_SECRET:pleasechangethissecrectokeyproductionforsecurityreasonsmustbe256bits}
        generator:
          access-token:
            expiration: 3600
        claims-validators:
          issuer: secman-backend-ng
    oauth2:
      enabled: true

# Email functionality configuration
secman:
  encryption:
    # Encryption password for sensitive data - MUST be overridden in production
    password: ${SECMAN_ENCRYPTION_PASSWORD:SecManDefaultEncryptionPassword2024}
    # Encryption salt - MUST be overridden in production
    salt: ${SECMAN_ENCRYPTION_SALT:5c0744940b5c369b}
  email:
    # Email delivery configuration
    retry:
      max-attempts: 3
      initial-delay: 30000  # 30 seconds
      max-delay: 300000     # 5 minutes
      backoff-multiplier: 2.0
    # Email performance settings
    performance:
      delivery-timeout: 30000  # 30 seconds
      connection-timeout: 10000  # 10 seconds
    # Notification settings
    notifications:
      batch-size: 50
      async-processing: true
    intercept-url-map:
      - pattern: /api/auth/login
        access:
          - isAnonymous()
      - pattern: /api/identity-providers/enabled
        access:
          - isAnonymous()
      - pattern: /oauth/**
        access:
          - isAnonymous()
      - pattern: /health
        access:
          - isAnonymous()
      - pattern: /api/auth/status
        access:
          - isAuthenticated()
      - pattern: "/api/**"
        access:
          - isAuthenticated()
  http:
    services:
      translation:
        url: https://openrouter.ai/api/v1
    client:
      read-timeout: 30s
      connect-timeout: 10s
      max-content-length: 1048576  # 1MB
      translation:
        read-timeout: 30s
        connect-timeout: 10s
      
oauth:
  http-client:
    url: https://api.github.com

datasources:
  default:
    url: jdbc:mariadb://localhost:3306/secman
    driverClassName: org.mariadb.jdbc.Driver
    username: ${DB_USERNAME:secman}
    password: ${DB_PASSWORD:CHANGEME}
    
jpa:
  default:
    properties:
      hibernate:
        hbm2ddl:
          auto: update
        show_sql: false
        format_sql: true
        dialect: org.hibernate.dialect.MariaDBDialect

jackson:
  dateFormat: yyyy-MM-dd'T'HH:mm:ss.SSSZ
  serialization:
    writeDatesAsTimestamps: false

logger:
  levels:
    com.secman: DEBUG
    io.micronaut.security: DEBUG

app:
  frontend:
    base-url: ${FRONTEND_URL:http://localhost:4321}