package com.secman.dto

import io.micronaut.serde.annotation.Serdeable

/**
 * DTO for vulnerability statistics grouped by asset type
 *
 * Represents aggregated vulnerability counts for a specific asset type,
 * used for identifying systemic vulnerabilities across infrastructure categories.
 *
 * Feature: 036-vuln-stats-lense
 * Task: T035 [US3]
 * Spec reference: spec.md FR-007, FR-008
 * User Story: US3 - View Asset Vulnerability Statistics (P3)
 * Data model: data-model.md Section "VulnerabilityByAssetTypeDto"
 */
@Serdeable
data class VulnerabilityByAssetTypeDto(
    /**
     * Asset type (e.g., "Server", "Workstation", "Network Device")
     * "Unknown" for assets without a type specified
     */
    val assetType: String,

    /**
     * Number of distinct assets of this type
     */
    val assetCount: Long,

    /**
     * Total vulnerability count across all assets of this type
     */
    val totalVulnerabilityCount: Long,

    /**
     * Count of CRITICAL severity vulnerabilities
     */
    val criticalCount: Long,

    /**
     * Count of HIGH severity vulnerabilities
     */
    val highCount: Long,

    /**
     * Count of MEDIUM severity vulnerabilities
     */
    val mediumCount: Long,

    /**
     * Count of LOW severity vulnerabilities
     */
    val lowCount: Long,

    /**
     * Average vulnerabilities per asset of this type
     * Calculated as: totalVulnerabilityCount / assetCount
     */
    val averageVulnerabilitiesPerAsset: Double
)
