package com.secman.dto

import io.micronaut.serde.annotation.Serdeable

/**
 * DTO for most common vulnerability statistics
 *
 * Represents a vulnerability ranked by its frequency of occurrence across
 * all accessible assets. Used for "Top 10 Most Common Vulnerabilities" display.
 *
 * Feature: 036-vuln-stats-lense
 * Task: T010 [US1]
 * Spec reference: spec.md FR-001, FR-002
 * Data model: data-model.md Section "MostCommonVulnerabilityDto"
 */
@Serdeable
data class MostCommonVulnerabilityDto(
    /**
     * CVE identifier (e.g., "CVE-2023-12345")
     * Max length: 255 characters
     */
    val vulnerabilityId: String,

    /**
     * CVSS severity level
     * Values: "CRITICAL", "HIGH", "MEDIUM", "LOW", "UNKNOWN"
     */
    val cvssSeverity: String,

    /**
     * Total occurrence count across all accessible assets
     * Must be > 0 (only vulnerabilities that exist are included)
     */
    val occurrenceCount: Long,

    /**
     * Number of distinct assets affected by this vulnerability
     * Must be > 0 and â‰¤ occurrenceCount
     * (One asset can have the same CVE multiple times, but typically once)
     */
    val affectedAssetCount: Long
)
