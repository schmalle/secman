package com.secman.dto

import io.micronaut.serde.annotation.Serdeable

/**
 * Response DTO for vulnerability import operation
 *
 * Provides detailed feedback on import results including counts and skipped rows.
 * Format: "X imported, Y skipped (invalid), Z assets created"
 *
 * Related to: Feature 003-i-want-to (Vulnerability Management System)
 *
 * @property message Human-readable summary message
 * @property imported Number of vulnerabilities successfully imported
 * @property skipped Number of rows skipped due to validation errors
 * @property assetsCreated Number of new assets auto-created during import
 * @property skippedDetails List of skipped row details (row number + reason)
 */
@Serdeable
data class VulnerabilityImportResponse(
    val message: String,
    val imported: Int,
    val skipped: Int,
    val assetsCreated: Int,
    val skippedDetails: List<SkippedRowDetail> = emptyList()
) {
    companion object {
        /**
         * Create response with formatted message
         */
        fun create(imported: Int, skipped: Int, assetsCreated: Int, skippedDetails: List<SkippedRowDetail> = emptyList()): VulnerabilityImportResponse {
            val message = "$imported imported, $skipped skipped (invalid), $assetsCreated assets created"
            return VulnerabilityImportResponse(message, imported, skipped, assetsCreated, skippedDetails)
        }
    }
}
