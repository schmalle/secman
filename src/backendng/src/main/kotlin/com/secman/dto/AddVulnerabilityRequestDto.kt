package com.secman.dto

import io.micronaut.serde.annotation.Serdeable
import jakarta.validation.constraints.Min
import jakarta.validation.constraints.NotBlank
import jakarta.validation.constraints.Pattern

/**
 * Request DTO for CLI add-vulnerability command
 * Feature: 052-cli-add-vulnerability (FR-001, FR-002, FR-003, FR-004)
 */
@Serdeable
data class AddVulnerabilityRequestDto(
    @field:NotBlank(message = "Hostname is required")
    val hostname: String,

    @field:NotBlank(message = "CVE is required")
    val cve: String,

    @field:NotBlank(message = "Criticality is required")
    @field:Pattern(
        regexp = "CRITICAL|HIGH|MEDIUM|LOW",
        message = "Criticality must be CRITICAL, HIGH, MEDIUM, or LOW"
    )
    val criticality: String,

    @field:Min(value = 0, message = "Days open must be a positive number or zero")
    val daysOpen: Int = 0
)
