package com.secman.dto

import io.micronaut.serde.annotation.Serdeable
import jakarta.validation.constraints.Min
import jakarta.validation.constraints.NotBlank
import jakarta.validation.constraints.Size

/**
 * DTO for individual vulnerability data in CrowdStrike import requests
 *
 * Feature: 032-servers-query-import
 * Used by: CrowdStrikeVulnerabilityBatchDto
 *
 * @property cveId CVE identifier (e.g., "CVE-2024-1234")
 * @property severity CVSS severity level (HIGH, CRITICAL)
 * @property affectedProduct Affected product/version information
 * @property daysOpen Number of days vulnerability has been open (minimum 30 per FR-004)
 */
@Serdeable
data class VulnerabilityDto(
    @field:NotBlank
    @field:Size(max = 255)
    val cveId: String,

    @field:NotBlank
    @field:Size(max = 50)
    val severity: String,

    @field:Size(max = 512)
    val affectedProduct: String?,

    @field:Min(0)
    val daysOpen: Int
)
