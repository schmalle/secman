{
  "name": "add_vulnerability",
  "description": "Add a vulnerability to an asset. Creates the asset if it doesn't exist. Requires ADMIN or VULN role via User Delegation.",
  "inputSchema": {
    "type": "object",
    "properties": {
      "hostname": {
        "type": "string",
        "description": "Hostname or asset name to add vulnerability to"
      },
      "cve": {
        "type": "string",
        "description": "CVE identifier (e.g., CVE-2024-1234)"
      },
      "criticality": {
        "type": "string",
        "enum": ["CRITICAL", "HIGH", "MEDIUM", "LOW"],
        "description": "Vulnerability severity level"
      },
      "daysOpen": {
        "type": "integer",
        "minimum": 0,
        "default": 0,
        "description": "Number of days the vulnerability has been open (for testing)"
      }
    },
    "required": ["hostname", "cve", "criticality"]
  },
  "outputSchema": {
    "type": "object",
    "properties": {
      "success": {
        "type": "boolean"
      },
      "vulnerabilityId": {
        "type": "integer",
        "description": "ID of created/updated vulnerability"
      },
      "assetId": {
        "type": "integer",
        "description": "ID of associated asset"
      },
      "assetCreated": {
        "type": "boolean",
        "description": "True if asset was newly created"
      },
      "message": {
        "type": "string"
      }
    }
  },
  "requiredRoles": ["ADMIN", "VULN"],
  "requiresDelegation": true,
  "operation": "WRITE"
}
