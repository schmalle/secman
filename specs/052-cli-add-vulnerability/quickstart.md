# Quickstart: CLI Add Vulnerability

**Feature**: 052-cli-add-vulnerability

## Usage

### Basic Command

```bash
# Add vulnerability to existing asset
./gradlew cli:run --args='add-vulnerability \
  --hostname webserver01 \
  --cve CVE-2024-1234 \
  --criticality HIGH \
  --days-open 30 \
  --username admin \
  --password secret'
```

### With Auto-Created Asset

```bash
# If hostname doesn't exist, asset is created automatically
./gradlew cli:run --args='add-vulnerability \
  --hostname newserver99 \
  --cve CVE-2023-5678 \
  --criticality CRITICAL \
  --days-open 15 \
  --username admin \
  --password secret'
```

### Using Custom Backend URL

```bash
./gradlew cli:run --args='add-vulnerability \
  --hostname webserver01 \
  --cve CVE-2024-1234 \
  --criticality MEDIUM \
  --days-open 0 \
  --backend-url http://api.example.com:8080 \
  --username admin \
  --password secret'
```

### With Verbose Output

```bash
./gradlew cli:run --args='add-vulnerability \
  --hostname webserver01 \
  --cve CVE-2024-1234 \
  --criticality HIGH \
  --days-open 30 \
  --username admin \
  --password secret \
  --verbose'
```

## Parameters

| Parameter | Required | Default | Description |
|-----------|----------|---------|-------------|
| `--hostname` | Yes | - | Target asset hostname |
| `--cve` | Yes | - | CVE identifier (e.g., CVE-2024-1234) |
| `--criticality` | Yes | - | CRITICAL, HIGH, MEDIUM, or LOW |
| `--days-open` | No | 0 | Number of days vulnerability has been open |
| `--username` | Yes | - | Backend username for authentication |
| `--password` | Yes | - | Backend password for authentication |
| `--backend-url` | No | http://localhost:8080 | Backend API URL |
| `--verbose` | No | false | Enable detailed logging |

## Output Examples

### Successful Creation

```
============================================================
Add Vulnerability
============================================================

Authenticating with backend...
✅ Authentication successful

Processing vulnerability...
Hostname: webserver01
CVE: CVE-2024-1234
Criticality: HIGH
Days Open: 30

✅ Vulnerability CVE-2024-1234 added to asset webserver01

============================================================
Summary
============================================================
Asset: webserver01
Operation: CREATED
```

### Asset Auto-Created

```
============================================================
Add Vulnerability
============================================================

Authenticating with backend...
✅ Authentication successful

Processing vulnerability...
Hostname: newserver99
CVE: CVE-2023-5678
Criticality: CRITICAL
Days Open: 15

⚠️  Asset newserver99 created (type: SERVER, owner: CLI-IMPORT)
✅ Vulnerability CVE-2023-5678 added to asset newserver99

============================================================
Summary
============================================================
Asset: newserver99 (auto-created)
Operation: CREATED
```

### Existing Vulnerability Updated

```
============================================================
Add Vulnerability
============================================================

Authenticating with backend...
✅ Authentication successful

Processing vulnerability...
Hostname: webserver01
CVE: CVE-2024-1234
Criticality: HIGH
Days Open: 45

✅ Vulnerability CVE-2024-1234 updated on asset webserver01

============================================================
Summary
============================================================
Asset: webserver01
Operation: UPDATED (existing vulnerability)
```

### Validation Error

```
❌ Error: Criticality must be CRITICAL, HIGH, MEDIUM, or LOW
   Received: IMPORTANT

Usage: add-vulnerability --hostname <host> --cve <cve> --criticality <level> [options]
```

## Exit Codes

| Code | Meaning |
|------|---------|
| 0 | Success |
| 1 | Validation error or authentication failure |
| 2 | Backend connection error |

## Prerequisites

1. Backend server running at specified URL
2. User with ADMIN or VULN role
3. Network connectivity to backend
